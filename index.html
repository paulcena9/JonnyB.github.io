<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Jonathan Bachman – Portfolio</title>
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* two-column layout */
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    .page-container {
      display: flex;
      height: 100%;
    }
    .content-wrapper {
      flex: 1;
      overflow-y: auto;
      position: relative;
      padding: 2rem;
      box-sizing: border-box;
    }
    .tree-container {
      flex: 0 0 40vw;
      height: 100%;
      position: relative;
      border-left: 1px solid #ddd;
      overflow: hidden;
    }
    /* season selector */
    .season-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
      z-index: 1000;
      background: rgba(255,255,255,0.8);
      padding: 0.4rem;
      border-radius: 4px;
      font-family: sans-serif;
    }
    /* hide fallback canvas */
    #tree-canvas {
      display: none;
    }
  </style>
</head>
<body>
  <div class="page-container">
    <!-- left column -->
    <div class="content-wrapper">
      <header id="hero" class="section-container hero-content">
        <nav>
          <a href="#intro">Intro</a>
          <a href="#writings">Writings</a>
          <a href="#projects">Projects</a>
          <a href="#contact">Contact</a>
        </nav>
        <h1>Jonny Bachman</h1>
        <p class="subtitle">
          MRI Support Specialist @ Neuroscape | UCSF &amp; Problem Solver
        </p>
      </header>

      <section id="intro" class="section-container">
        <!-- … your intro markup … -->
      </section>

      <section id="writings" class="section-container">
        <!-- … your writings markup … -->
      </section>

      <section id="projects" class="section-container">
        <!-- … your projects markup … -->
      </section>

      <section id="contact" class="section-container">
        <!-- … your contact markup … -->
      </section>

      <footer class="section-container">
        <p>© 2025 Jonny Bachman. All rights reserved.</p>
      </footer>
    </div>

    <!-- right column: P5 sketch + season UI -->
    <div class="tree-container" id="pine-container">
      <div class="season-toggle">
        <label for="season-select">Season:</label>
        <select id="season-select">
          <option value="spring">Spring</option>
          <option value="summer">Summer</option>
          <option value="fall">Fall</option>
          <option value="winter">Winter</option>
        </select>
      </div>
      <canvas id="tree-canvas"></canvas>
    </div>
  </div>

  <!-- p5.js & noise -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
  <!-- site main -->
  <script src="js/main.js"></script>

  <!-- Breathing Fractal Pine with Seasons -->
  <script>
    let noiseGen, t = 0, season = 'spring';
    const flakes = [], leaves = [];
    const MAX_FLAKES = 200, MAX_LEAVES = 100;

    // hill params
    const hillYFactor = 0.85, hillAmp = 10, hillStep = 5;

    document.getElementById('season-select')
      .addEventListener('change', e => {
        season = e.target.value;
        // reset particles
        flakes.length = 0; leaves.length = 0;
      });

    function setup() {
      const container = document.getElementById('pine-container');
      const w = container.clientWidth, h = container.clientHeight;
      const cnv = createCanvas(w, h);
      cnv.parent('pine-container');
      noiseGen = new SimplexNoise();
      strokeCap(ROUND);
    }

    function windowResized() {
      const c = document.getElementById('pine-container');
      resizeCanvas(c.clientWidth, c.clientHeight);
    }

    function draw() {
      t += deltaTime * 0.001;
      clear();

      // background by season
      if (season === 'summer') drawSunset();
      else background(200, 225, 255);

      // hill (winter: snow-white)
      if (season === 'winter') fill(240);
      else fill(80, 170, 70);
      noStroke();
      beginShape();
      vertex(0, height);
      for (let x = 0; x <= width; x += hillStep) {
        vertex(x, getHillY(x));
      }
      vertex(width, height);
      endShape(CLOSE);

      // particles
      if (season === 'winter')   updateSnow();
      else if (season === 'fall') updateLeaves();

      // tree anchored to hill
      const treeX = width * 0.5, treeY = getHillY(treeX);
      drawPine(treeX, treeY, height * 0.3, 7);
    }

    function getHillY(x) {
      return height * hillYFactor + sin((x*0.01)+t*0.5)*hillAmp;
    }

    function drawSunset() {
      // simple gradient sky
      for (let y = 0; y < height; y++) {
        const inter = constrain(y/(height*0.6),0,1);
        const c = lerpColor(color(255,94,77), color(255,212,128), inter);
        stroke(c); line(0,y,width,y);
      }
    }

    function updateSnow() {
      // add flakes
      if (flakes.length < MAX_FLAKES) {
        flakes.push({ x: random(width), y: -10, size: random(2,6), speed: random(20,60) });
      }
      fill(255);
      noStroke();
      // draw & fall
      for (let i = flakes.length -1; i >= 0; i--) {
        const f = flakes[i];
        f.y += f.speed * deltaTime * 0.001;
        ellipse(f.x, f.y, f.size);
        if (f.y > height) flakes.splice(i,1);
      }
    }

    function updateLeaves() {
      if (leaves.length < MAX_LEAVES) {
        leaves.push({
          x: random(width), y: -10,
          size: random(8,16), 
          speed: random(30,80),
          angle: random(TWO_PI),
          spin: random(-0.03,0.03),
          col: color(200, random(100,50), 0)
        });
      }
      noStroke();
      // draw & fall
      for (let i = leaves.length -1; i >= 0; i--) {
        const L = leaves[i];
        L.y += L.speed * deltaTime * 0.001;
        L.x += cos(L.angle)*20*deltaTime*0.001;
        L.angle += L.spin;
        fill(L.col);
        push(); translate(L.x,L.y); rotate(L.angle);
        ellipse(0,0, L.size*0.6, L.size);
        pop();
        if (L.y > height) leaves.splice(i,1);
      }
    }

    function drawPine(x, y, len, depth) {
      push();
      translate(x, y);
      // trunk
      stroke(80, 40, 20);
      strokeWeight(map(depth, 0, 7, 2, 24));
      line(0, 0, 0, -len);
      translate(0, -len);

      if (depth > 0) {
        const baseAngle = PI/8;
        const sway = noiseGen.noise2D(depth, t*0.3)*0.15;
        drawPine(0,0,len*0.7,depth-1);
        rotate(-baseAngle + sway);
        drawPine(0,0,len*0.7,depth-1);
        rotate(2*(baseAngle - sway));
        drawPine(0,0,len*0.7,depth-1);
      } else {
        // needles
        const fanCount = 8;
        const pulse = map(noiseGen.noise2D(t, x*0.001), -1,1, -2,2);
        const size = len*0.5 + pulse;
        for (let i=-fanCount; i<=fanCount; i++) {
          const ang = map(i,-fanCount,fanCount,-PI/2,PI/2)*0.6;
          push(); rotate(ang);
          strokeWeight(1.5);
          // winter needles white
          if (season==='winter') stroke(255);
          else stroke(30,100,30,200);
          line(0,0,0,-size);
          pop();
        }
      }
      pop();
    }
  </script>
</body>
</html>